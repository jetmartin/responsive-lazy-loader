<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Responsive-lazy-loader : A responsive lazy loader. Load image rendition according to CSS display &amp; breakpoint." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Responsive-lazy-loader</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <span  id="share_me">
            <a
              href="https://twitter.com/share"
              class="twitter-share-button"
              data-lang="en"
              data-count="none"
              data-url="http://jetmartin.github.io/responsive-lazy-loader"
              data-text="Responsive-lazy-loader : Load image rendition according to CSS display & breakpoint.">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          </span>

          <a id="forkme_banner" href="https://github.com/jetmartin/responsive-lazy-loader">View on GitHub</a>

          <h1 id="project_title">Responsive-lazy-loader</h1>
          <h2 id="project_tagline">A responsive lazy loader. Load image rendition according to CSS display &amp; breakpoint.</h2>

            <section id="downloads">
              <a class="project_demo" href="demo.html">Demo.</a>
              <a class="zip_download_link" href="https://github.com/jetmartin/responsive-lazy-loader/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/jetmartin/responsive-lazy-loader/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="responsive-lazy-loader" class="anchor" href="#responsive-lazy-loader"><span class="octicon octicon-link"></span></a>responsive-lazy-loader</h1>

<p>A responsive lazy loader. Load image rendition according to CSS display &amp; breakpoint.</p>

<div id="toc"></div>

<h2>
<a name="main-fraime" class="anchor" href="#main-fraime"><span class="octicon octicon-link"></span></a>Main frame</h2>

<p>Responsive lazy loader allows you lo load the most appropriate image renditions according to the current breakpoint and to the current display into the CSS grid-system.</p>

<p>It can be used as a simple lazy loader, simply as a responsive lazy loader (taking care of the breakpoint) or as an advanced lazy loader taking care of breakpoint and display.</p>

<h3>
<a name="how-it-works" class="anchor" href="#how-it-works"><span class="octicon octicon-link"></span></a>How it works</h3>

<p>The lazy loader recognizes the current display (size in a grid system for example) and breakpoint (mediaquery) and replaces a token in the image URL.</p>

<p>It works with any HTML/CSS structure/framework as bootstrap or foundation and any image provider as Flickr or CMS using image preset (rendition, styles, ...) as Adobe CQ or Drupal.</p>

<p>The plugin is only 3Ko (minified).</p>

<h2>
<a name="how-to-use" class="anchor" href="#how-to-use"><span class="octicon octicon-link"></span></a>How to use</h2>

<h3>
<a name="html" class="anchor" href="#html"><span class="octicon octicon-link"></span></a>HTML</h3>

<p>Replace your img tags by the following :</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;img</span> <span class="na">class=</span><span class="s">"img-responsive"</span> <span class="na">data-src=</span><span class="s">"http://www.domain.tld/img-[[display]].jpg"</span> <span class="na">src=</span><span class="s">"js/pixel.gif"</span> <span class="na">alt=</span><span class="s">"image"</span><span class="nt">&gt;</span>
<span class="nt">&lt;noscript&gt;&lt;img</span> <span class="na">class=</span><span class="s">"image-asset"</span> <span class="na">src=</span><span class="s">"http://www.domain.tld/img-defaults.jpg"</span> <span class="na">alt=</span><span class="s">"image"</span><span class="nt">&gt;&lt;/noscript&gt;</span>
</pre></div>

<h3>
<a name="css" class="anchor" href="#css"><span class="octicon octicon-link"></span></a>CSS</h3>

<p>The image size must be at 100% for the image to be "responsive", it means that the image will be adjusted to the parent element. You must set up your breakpoint to never upscale an image and to load the image closest to the maximum display width.</p>

<p>For example, if your site is 1200px on desktop you have to load an image as close as possible to 1200px but on a phone, if your max-width is 320 pixels, you have to load an image as close as possible to 320 but not too small.</p>

<p>For a nice display, you need to use a "loader" background for the images and/or outline.
It could be something like :</p>

<div class="highlight highlight-css"><pre><span class="nc">.img-responsive</span><span class="p">{</span>
    <span class="k">width</span><span class="o">:</span><span class="m">100</span><span class="o">%</span><span class="p">;</span>
    <span class="k">outline</span><span class="o">:</span><span class="m">#aaa</span><span class="p">;</span>
    <span class="k">background</span><span class="o">:</span><span class="m">#ccc</span> <span class="sx">url(../img/loader.gif)</span> <span class="k">center</span> <span class="k">center</span> <span class="k">no-repeat</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Add the noscript fallback :</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;noscript&gt;&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span> <span class="na">media=</span><span class="s">"all"</span><span class="nt">&gt;img</span><span class="o">[</span><span class="nt">data-src</span><span class="o">]</span> <span class="p">{</span> <span class="k">display</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span> <span class="p">}</span><span class="nt">&lt;/style&gt;&lt;/noscript&gt;</span>
</pre></div>

<p>Always use the "desktop" as default value because almost all modern device browsers support mediaqueries detections. This is not the case for old desktop browsers, such as old IE, so the current mediaquery will always be the "defaults" one. Even in an old browser, the display will be recognized and the appropriate image will load anyway.</p>

<h3>
<a name="tip" class="anchor" href="#tip"><span class="octicon octicon-link"></span></a>Tip</h3>

<p>The height auto is not displayed the same way on all the browsers.
To prevent the image height to change on an image load (text moving effect in some browsers), the image height has to be managed in CSS according to the site layout.</p>

<p>If all the images do not necessary have the same ratio (as 16/9 or 4/3), you can use the onImageShow callback function for custom actions.</p>

<h2>
<a name="how-to-configure" class="anchor" href="#how-to-configure"><span class="octicon octicon-link"></span></a>How to configure</h2>

<p>You can add arguments on the function call or override the defaults.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">$</span><span class="p">(</span><span class="s2">"img[data-src]"</span><span class="p">).</span><span class="nx">responsivelazyloader</span><span class="p">({</span>
    <span class="nx">mediaQueries</span> <span class="o">:</span> <span class="p">{</span>  <span class="c1">// The mediaqueries used by the lazyloder.</span>
      <span class="s1">'phone'</span>   <span class="o">:</span> <span class="s2">"(max-width: 767px)"</span><span class="p">,</span>
      <span class="s1">'tablet'</span>  <span class="o">:</span> <span class="s2">"(min-width: 768px) and (max-width: 991px)"</span><span class="p">,</span>
      <span class="s1">'desktop'</span> <span class="o">:</span> <span class="s2">"(min-width: 992px)"</span>
    <span class="p">},</span>
    <span class="nx">displays</span> <span class="o">:</span> <span class="p">{</span>  <span class="c1">// The displays to combine grid system &amp; mediaqueries</span>
        <span class="s1">'defaults'</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s1">'display'</span> <span class="o">:</span> <span class="p">{</span>
                <span class="s1">'desktop'</span>  <span class="o">:</span> <span class="s1">'b'</span><span class="p">,</span>   <span class="c1">//1024</span>
                <span class="s1">'tablet'</span>   <span class="o">:</span> <span class="s1">'z'</span><span class="p">,</span>   <span class="c1">//640</span>
                <span class="s1">'phone'</span>    <span class="o">:</span> <span class="s1">'m'</span><span class="p">,</span>   <span class="c1">//320</span>
                <span class="s1">'defaults'</span> <span class="o">:</span> <span class="s1">'b'</span>    <span class="c1">//1024</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>Or</p>

<div class="highlight highlight-javascript"><pre><span class="c1">// Owerrde defaults</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">responsivelazyloader</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">mediaQueries</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1">// The mediaqueries used by the lazyloder.</span>
        <span class="s1">'phone'</span>    <span class="o">:</span> <span class="s2">"(max-width: 767px)"</span><span class="p">,</span>
        <span class="s1">'tablet'</span>   <span class="o">:</span> <span class="s2">"(min-width: 768px) and (max-width: 991px)"</span><span class="p">,</span>
        <span class="s1">'desktop'</span>  <span class="o">:</span> <span class="s2">"(min-width: 992px)"</span>
    <span class="p">};</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">responsivelazyloader</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">displays</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// The displays to combine grid system &amp; mediaqueries</span>
        <span class="s1">'defaults'</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s1">'display'</span> <span class="o">:</span> <span class="p">{</span>
                <span class="s1">'desktop'</span>  <span class="o">:</span> <span class="s1">'b'</span><span class="p">,</span>   <span class="c1">//1024</span>
                <span class="s1">'tablet'</span>   <span class="o">:</span> <span class="s1">'z'</span><span class="p">,</span>   <span class="c1">//640</span>
                <span class="s1">'phone'</span>    <span class="o">:</span> <span class="s1">'m'</span><span class="p">,</span>   <span class="c1">//320</span>
                <span class="s1">'defaults'</span> <span class="o">:</span> <span class="s1">'b'</span>    <span class="c1">//1024</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"img[data-src]"</span><span class="p">).</span><span class="nx">responsivelazyloader</span><span class="p">();</span>
</pre></div>

<h2>
<a name="how-to-use-breakpoints" class="anchor" href="#how-to-use-breakpoints"><span class="octicon octicon-link"></span></a>How to use Breakpoints (mediaQueries)</h2>

<p>In order to be consistant with CSS declaration, the latest valid mediquery will be used.
	<br />You can use simple mediaqueries or more complex ones using orientation or pixel-ratio.
	<br />To start in a simple way with the plugin, copy/past the mediaqueries in the same order from your steelsheets.</p>

<h2>
<a name="use-multiple-displays" class="anchor" href="#use-multiple-displays"><span class="octicon octicon-link"></span></a>Use Multiple displays</h2>

<p>Do not use multiple instances of the plugin, use the displays.</p>

<p>You can declare diffrent configuration for some images in the same page using the displays config element.
	<br />The first valid display will be used for each image.
	<br />You can specify multiples "displays" using a "gridClass" (on the image itself or a parent element).
	<br />The "parent" parameter is now optional. If you decalre a "parent" element, it must have the "gridClass".</p>

<p><strong>"parent"</strong> is a jQuery element declaration as ".myParentClass" or "section.myParentClass".
	<br /><strong>"gridClass"</strong> is a class name as "myDisplayClass".</p>
<p>Always use a "defaults" display and a "defaults" on each display to prevent issues and to make display detection usable with old browsers.</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;section&gt;</span>
  <span class="nt">&lt;article</span> <span class="na">class=</span><span class="s">"sidebar"</span> <span class="nt">&gt;</span>{...}<span class="nt">&lt;/article&gt;</span>
  <span class="nt">&lt;aside</span> <span class="na">class=</span><span class="s">"sidebar"</span> <span class="nt">&gt;</span>{...}<span class="nt">&lt;/aside&gt;</span>
<span class="nt">&lt;/section&gt;</span></pre></div>
<div class="highlight highlight-javascript"><pre>
<span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">responsivelazyloader</span><span class="p">.</span><span class="nx">defaults</span><span class="p">.</span><span class="nx">displays</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// The displays to combine grid system &amp; mediaqueries</span>
        <span class="s1">'articleWithSidebar'</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s1">'parent'</span> <span class="o">:</span> <span class="s1">'article.sidebar'</span><span class="p">,</span>
            <span class="s1">'gridClass'</span> <span class="o">:</span> <span class="s1">'sidebar'</span><span class="p">,</span>
            <span class="s1">'display'</span> <span class="o">:</span> <span class="p">{</span>
                <span class="s1">'phone'</span>    <span class="o">:</span> <span class="s1">'m'</span><span class="p">,</span>   <span class="c1">//320</span>
                <span class="s1">'defaults'</span> <span class="o">:</span> <span class="s1">'z'</span>    <span class="c1">//640</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s1">'sidebar'</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s1">'gridClass'</span> <span class="o">:</span> <span class="s1">'sidebar'</span><span class="p">,</span>
            <span class="s1">'display'</span> <span class="o">:</span> <span class="p">{</span>
                <span class="s1">'defaults'</span> <span class="o">:</span> <span class="s1">'m'</span>    <span class="c1">//320</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s1">'defaults'</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s1">'display'</span> <span class="o">:</span> <span class="p">{</span>
                <span class="s1">'desktop'</span>  <span class="o">:</span> <span class="s1">'b'</span><span class="p">,</span>   <span class="c1">//1024</span>
                <span class="s1">'tablet'</span>   <span class="o">:</span> <span class="s1">'z'</span><span class="p">,</span>   <span class="c1">//640</span>
                <span class="s1">'phone'</span>    <span class="o">:</span> <span class="s1">'m'</span><span class="p">,</span>   <span class="c1">//320</span>
                <span class="s1">'defaults'</span> <span class="o">:</span> <span class="s1">'b'</span>    <span class="c1">//1024</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
</pre></div>
	
<h2>
<a name="override-image-url" class="anchor" href="#override-image-url"><span class="octicon octicon-link"></span></a>Override image url for display and/or breakpoint</h2>
<p>The image url can be overriden for a specific display and/or breakpoint using some additionals attributs.</p>
<ol>
	<li>"data-src-{display}-{mediaquerie}" will override image url for a combinaison of display & breakpoint.</li>
	<li>"data-src-{display}" will override image url for a display.</li>
	<li>"data-src-{mediaquerie}" will override image url for a breakpoint (mediaquerie).</li>
</ol>
<p>Where "{display}" and "{mediaquerie}" are teh display and mediaquerie names in settings array.</p>
<p>Important notice about the "Token" on the image urls.</p>
<ol>
	<li>If you use it, the images will be loaded according to the configuration of the lazyloader.</li>
	<li>If you do not use it, the same image will be loaded for each displays/breakpoints.</li>
</ol>
<p>If your CMS/Framwork do not allows you to use non valid images urls (using token), you can use this way to use the lazyloader. In this case, to prevent bugs, set a "data-src-defaults" attribut.</p>
<p>The following exemple is for a breakpoint name "phone" and a display name "sidebar". The image loaded on display "sidebar" will be a specif one using the responsive token. The images loaded for the breakpoint "phone" do not use the responsie token.</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;img</span>
  <span class="na">class=</span><span class="s">"img-responsive"</span>
  <span class="na">data-src-sidebar-phone=</span><span class="s">"http://www.domain.tld/an-image.jpg"</span>
  <span class="na">data-src-sidebar=</span><span class="s">"http://www.domain.tld/another-image-[[display]].jpg"</span>
  <span class="na">data-src-phone=</span><span class="s">"http://www.domain.tld/a-third-image.jpg"</span>
  <span class="na">data-src=</span><span class="s">"http://www.domain.tld/img-[[display]].jpg"</span>
  <span class="na">src=</span><span class="s">"js/pixel.gif"</span>
  <span class="na">alt=</span><span class="s">"image"</span>
  <span class="nt">&gt;</span>
<span class="nt">&lt;noscript&gt;&lt;img</span> <span class="na">class=</span><span class="s">"image-asset"</span> <span class="na">src=</span><span class="s">"http://www.domain.tld/img-defaults.jpg"</span> <span class="na">alt=</span><span class="s">"image"</span><span class="nt">&gt;&lt;/noscript&gt;</span>
</pre></div>

<h2>
<a name="ajax" class="anchor" href="#ajax"><span class="octicon octicon-link"></span></a>AJAX</h2>

<p>The lazyloader can be used with AJAX.</p>

<div class="highlight highlight-javascript"><pre><span class="c1">// Init lazyloader</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"img[data-src]"</span><span class="p">).</span><span class="nx">responsivelazyloader</span><span class="p">();</span>
<span class="c1">// Init lazyloder after ajax events.</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">document</span><span class="p">).</span><span class="nx">ajaxStop</span><span class="p">(</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"img[data-src]"</span><span class="p">).</span><span class="nx">responsivelazyloader</span><span class="p">();</span> <span class="p">});</span>
</pre></div>

<h2>
<a name="settings" class="anchor" href="#settings"><span class="octicon octicon-link"></span></a>Settings</h2>

<p>All available settings :</p>

<ol>
<li>distance        = Int      | distance of the image to the viewable browser screen before it gets loaded</li>
<li>token           = string   | The token replaced by the current display pattern.</li>
<li>force           = Bool     | Force loading without distance.</li>
<li>mediaQueries    = Object   | The mediaquery used by the lazy loader.</li>
<li>displays        = Object   | The display properties, match the grid class and the mediaqueries</li>
<li>onImageShow     = function | Callback when an image has been lazy loaded.</li>
<li>onImageError    = function | Callback when an image could not be lazy loaded.</li>
<li>onAllImagesLoad = function | Callback when all the images of the set are loaded.</li>
</ol><p>Custom events :</p>

<ol>
<li>responsiveImageLoaded -&gt; Trigger on each image load. Custom var :
    - image : The currently loaded image.</li>
<li>onMediaqueryChange -&gt; Trigger when mediaquery has change. Custom var :
    - CurrentMediaQuery : the current mediaquery key according to Settings.mediaQueries.
    - PreviousMediaQuery : The previous mediaquery key according to Settings.mediaQueries.</li>
</ol><h2>
<a name="debug" class="anchor" href="#debug"><span class="octicon octicon-link"></span></a>Debug</h2>

<p>To help you setup the lazyloader, you can use the following code :</p>

<div class="highlight highlight-javascript"><pre><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'responsiveImageLoaded'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
    <span class="nx">$image</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">image</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nx">$image</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">$image</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span>
        <span class="s2">"&lt;p&gt;Current mediaquerry : "</span> <span class="o">+</span> <span class="nx">$image</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"data-current-mediaq"</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">"&lt;br /&gt;Current display : "</span> <span class="o">+</span> <span class="nx">$image</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"data-display"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"&lt;/p&gt;"</span>
    <span class="p">);</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="more" class="anchor" href="#more"><span class="octicon octicon-link"></span></a>More</h2>

<p>See the responsive lazy loader page on jQuery : <a href="http://plugins.jquery.com/responsivelazyloader">http://plugins.jquery.com/responsivelazyloader</a></p>

<p>You can also use Responsive Lazy Loader on Drupal using our Drupal Module : <a href="https://drupal.org/sandbox/jetmartin/2158105">https://drupal.org/sandbox/jetmartin/2158105</a></p>

<p>For more information, please contact me <a href="https://twitter.com/J_et_martin" title="Go to Twitter" target="_blank">@j_et_martin</a>.</p>

<h3>
<a name="valtech" class="anchor" href="#valtech"><span class="octicon octicon-link"></span></a>Valtech</h3>

<p>This module is supported by Valtech : <a href="http://www.valtech.fr">http://www.valtech.fr</a></p>

<h2>
<a name="they-talk-about-it" class="anchor" href="#they-talk-about-it"><span class="octicon octicon-link"></span></a>They talk about it</h2>
<ul>
	<li><a href="http://plugins.jquery.com/responsivelazyloader/" title="Go to plugins.jquery.com"target="_blank">The jQuery Plugin page</a></li>
	<li><a href="http://jquery-plugins.net/responsive-lazy-loader-plugin" title="Go to jquery-plugins.net"target="_blank">jquery-plugins.net</a></li>
	<li><a href="http://www.jqueryrain.com/2013/12/jquery-responsive-lazy-loader/" title="Go to jqueryrain.com"target="_blank">jqueryrain.com</a></li>
	<li><a href="http://flipsblog.jp/archives/533" title="Go to flipsblog.jp"target="_blank">flipsblog.jp</a></li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Responsive-lazy-loader maintained by <a href="https://github.com/jetmartin" title="Go to Github." target="_blank">jetmartin</a>.<br />Find me on twitter <a href="https://twitter.com/J_et_martin" title="Go to Twitter" target="_blank">@j_et_martin</a></p>
      </footer>
    </div>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js" charset="utf-8"></script>
<script type="text/javascript" src="javascripts/main.js" charset="utf-8"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-46561768-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
